OBJECT=IPLANSZALAST
IPLANSZALAST:TYPE=INTEGER
IPLANSZALAST:VALUE=0

OBJECT=SWALKERSIGNAL
SWALKERSIGNAL:TYPE=STRING
SWALKERSIGNAL:ONBRUTALCHANGED^KRET_TARGET_REACHED={SKRETTARGETACTIONSEL^SET([""+SCLICKSEL]);}
#SWALKERSIGNAL:ONBRUTALCHANGED^KRET_GO_ON={SKRETGOONACTIONSEL^SET([""+KRET^GETNEXTSTEPX()+"_"+KRET^GETNEXTSTEPY()]);}

#OBJECT=SKRETGOONACTIONSEL
#SKRETGOONACTIONSEL:TYPE=STRING
#SKRETGOONACTIONSEL:ONBRUTALCHANGED^27_21={}

# Action after player gets to destination.

OBJECT=SKRETTARGETACTIONSEL
SKRETTARGETACTIONSEL:TYPE=STRING
SKRETTARGETACTIONSEL:ONBRUTALCHANGED={GSAVE^SET("ARCADE_LEADER_POS_X",KRET^GETPOSX());GSAVE^SET("ARCADE_LEADER_POS_Y",KRET^GETPOSY());}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^ANNPODWORKOMASK={GSAVE^SET("ARCADE_SCENE_NAME","PODWORKO");GSAVE^SET("ARCADE_LEADER_POS_X",6);GSAVE^SET("ARCADE_LEADER_POS_Y",7);BEHGOTOSCENE^RUN();}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^WAZNIEJSZY_PRZEDMIOT={ /
@IF("KRET^GETPOSX()'14&&KRET^GETPOSY()'13"," /
BEHDIALOGPLAY^RUN("kretb4",FALSE); /
    INV^ADD("WAZNIEJSZY_PRZEDMIOT"); /
    WAZNIEJSZY_PRZEDMIOT^SETPOSITION(1000,1000); /
    GSAVE^SET("WAZNIEJSZY_PRZEDMIOT",1);} /
","{ /
    BEHDIALOGPLAY^RUN("kretb2",FALSE); /
}");}




# After clicking an object, sets the position player character should go to.
OBJECT=SCLICKSEL
SCLICKSEL:TYPE=STRING
SCLICKSEL:ONBRUTALCHANGED={@IF(MOUSE^GETPOSY(),">","0","{KRET^GOTOMOUSE(IMOUSEX,IMOUSEY);}","");}
SCLICKSEL:ONBRUTALCHANGED^KRET={INV^ROZWIN(KRET^GETCENTERX(),KRET^GETCENTERY());}
SCLICKSEL:ONBRUTALCHANGED^ANNPODWORKOMASK={KRET^GOTO(4,15);}
SCLICKSEL:ONBRUTALCHANGED^WAZNIEJSZY_PRZEDMIOT={KRET^GOTO(14,13);}

OBJECT=POSTESTER
POSTESTER:TYPE=BEHAVIOUR
POSTESTER:CODE={KRET^SHOWINFO(MOUSE^GETPOSX(),MOUSE^GETPOSY());}

# Action after hovering over object.
OBJECT=SFOCUSSEL
SFOCUSSEL:TYPE=STRING
SFOCUSSEL:ONCHANGED={CURSOR^SET("STD");}
SFOCUSSEL:ONCHANGED^ANNKOGUT={CURSOR^SET("ACTIVE");}
SFOCUSSEL:ONCHANGED^ANNPODWORKOMASK={CURSOR^SET("EXIT");}
SFOCUSSEL:ONCHANGED^WAZNIEJSZY_PRZEDMIOT={CURSOR^SET("ACTIVE");}

# Action that happens after specified dialogue is finished.
OBJECT=SDIALOGSIGNAL
SDIALOGSIGNAL:TYPE=STRING
SDIALOGSIGNAL:ONBRUTALCHANGED^KOGUT0={}

OBJECT=BJPKZAGADANE
BJPKZAGADANE:TYPE=BOOL
BJPKZAGADANE:VALUE=FALSE

OBJECT=WAZNIEJSZY_PRZEDMIOT
WAZNIEJSZY_PRZEDMIOT:TYPE=ANIMO
WAZNIEJSZY_PRZEDMIOT:VISIBLE=TRUE
WAZNIEJSZY_PRZEDMIOT:FILENAME=KURNIKI\WAZNIEJSZY_PRZEDMIOT.ANN
WAZNIEJSZY_PRZEDMIOT:TOCANVAS=TRUE
WAZNIEJSZY_PRZEDMIOT:PRIORITY=400
WAZNIEJSZY_PRZEDMIOT:FPS=16
WAZNIEJSZY_PRZEDMIOT:PRELOAD=TRUE
WAZNIEJSZY_PRZEDMIOT:RELEASE=TRUE
WAZNIEJSZY_PRZEDMIOT:MONITORCOLLISION=FALSE
WAZNIEJSZY_PRZEDMIOT:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNPODWORKOMASK
ANNPODWORKOMASK:TYPE=ANIMO
ANNPODWORKOMASK:VISIBLE=FALSE
ANNPODWORKOMASK:FILENAME=KURNIKI\PODWORKO_MASK.ANN
ANNPODWORKOMASK:TOCANVAS=TRUE
ANNPODWORKOMASK:PRIORITY=399
ANNPODWORKOMASK:FPS=16
ANNPODWORKOMASK:PRELOAD=TRUE
ANNPODWORKOMASK:RELEASE=TRUE
ANNPODWORKOMASK:MONITORCOLLISION=FALSE
ANNPODWORKOMASK:MONITORCOLLISIONALPHA=FALSE

OBJECT=CNVINIT
CNVINIT:TYPE=BEHAVIOUR
CNVINIT:CODE={BEHMUSICSET^RUN("KURNIKI");CLSWALKEROBJ^NEW("KRET");KRET^LOADANIM("KRET22");KRET^SETSPEED(3.0);DBDIALOGI^REMOVEALL();DBDIALOGI^LOAD("KURNIKI\DIALOGI.DTA");BEHDIALOGSTOP^RUN(FALSE);CANVASOBSERVER^SETBACKGROUND("KURNIKI\BKG.IMG");BEHINITPLAN^RUN(TRUE);KRET^LOADPATH("KURNIKI\PATHS","IDLE",800,600);KRET^SETPOS(GSAVE^GET("ARCADE_LEADER_POS_X"),GSAVE^GET("ARCADE_LEADER_POS_Y"),FALSE);KRET^SETPATH(1,TRUE);KRET^GOTO(5,13);@IF(GSAVE^GET("KURNIKI_STATUS"),"_",""NIEODWIEDZONY"","BFIRST","");}

OBJECT=BFIRST
BFIRST:TYPE=BEHAVIOUR
BFIRST:CODE={GSAVE^SET("KURNIKI_STATUS","ODWIEDZONY");BEHDIALOGPLAY^RUN("kretb1",FALSE); /}

OBJECT=BEHINITPLAN
BEHINITPLAN:TYPE=BEHAVIOUR
BEHINITPLAN:CODE={@IF(GSAVE^GET("WAZNIEJSZY_PRZEDMIOT"),"_","1","{WAZNIEJSZY_PRZEDMIOT^SETPOSITION(1000,1000);}","");}
