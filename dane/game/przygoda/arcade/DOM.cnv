OBJECT=IPLANSZALAST
IPLANSZALAST:TYPE=INTEGER
IPLANSZALAST:VALUE=0

OBJECT=SWALKERSIGNAL
SWALKERSIGNAL:TYPE=STRING
SWALKERSIGNAL:ONBRUTALCHANGED^KRET_TARGET_REACHED={SKRETTARGETACTIONSEL^SET([""+SCLICKSEL]);}
#SWALKERSIGNAL:ONBRUTALCHANGED^KRET_GO_ON={SKRETGOONACTIONSEL^SET([""+KRET^GETNEXTSTEPX()+"_"+KRET^GETNEXTSTEPY()]);}

#OBJECT=SKRETGOONACTIONSEL
#SKRETGOONACTIONSEL:TYPE=STRING
#SKRETGOONACTIONSEL:ONBRUTALCHANGED^27_21={}

# Action after player gets to destination.

OBJECT=SKRETTARGETACTIONSEL
SKRETTARGETACTIONSEL:TYPE=STRING
SKRETTARGETACTIONSEL:ONBRUTALCHANGED={GSAVE^SET("ARCADE_LEADER_POS_X",KRET^GETPOSX());GSAVE^SET("ARCADE_LEADER_POS_Y",KRET^GETPOSY());}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^ANNUBOA={BEHDIALOGPLAY^RUN("UBOA",FALSE);}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^ANNDOORMASK={BEHDIALOGPLAY^RUN("CLOSED",FALSE);}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^ANNBUTTONMASK={}

# After clicking an object, sets the position player character should go to.

OBJECT=SCLICKSEL
SCLICKSEL:TYPE=STRING
SCLICKSEL:ONBRUTALCHANGED={@IF(MOUSE^GETPOSY(),">","0","{KRET^GOTOMOUSE(IMOUSEX,IMOUSEY);}","");}
SCLICKSEL:ONBRUTALCHANGED^KRET={INV^ROZWIN(KRET^GETCENTERX(),KRET^GETCENTERY());}
SCLICKSEL:ONBRUTALCHANGED^ANNUBOA={KRET^GOTO(21,21);}
SCLICKSEL:ONBRUTALCHANGED^ANNDOORMASK={KRET^GOTO(5,21);}
SCLICKSEL:ONBRUTALCHANGED^ANNBUTTONMASK={KRET^GOTO(8,18);}

OBJECT=POSTESTER
POSTESTER:TYPE=BEHAVIOUR
POSTESTER:CODE={KRET^SHOWINFO(MOUSE^GETPOSX(),MOUSE^GETPOSY());}


# Action after hovering over object.

OBJECT=SFOCUSSEL
SFOCUSSEL:TYPE=STRING
SFOCUSSEL:ONCHANGED={CURSOR^SET("STD");}
SFOCUSSEL:ONCHANGED^ANNUBOA={CURSOR^SET("ACTIVE");}
SFOCUSSEL:ONCHANGED^ANNDOORMASK={CURSOR^SET("EXIT");}
SFOCUSSEL:ONCHANGED^ANNBUTTONMASK={CURSOR^SET("ACTIVE");}

# Action that happens after specified dialogue is finished.
OBJECT=SDIALOGSIGNAL
SDIALOGSIGNAL:TYPE=STRING
SDIALOGSIGNAL:ONBRUTALCHANGED^UBOA={}

OBJECT=BJPKZAGADANE
BJPKZAGADANE:TYPE=BOOL
BJPKZAGADANE:VALUE=FALSE

OBJECT=ANNUBOA
ANNUBOA:TYPE=ANIMO
ANNUBOA:VISIBLE=TRUE
ANNUBOA:FILENAME=DOM\UBOA.ANN
ANNUBOA:TOCANVAS=TRUE
ANNUBOA:PRIORITY=400
ANNUBOA:FPS=16
ANNUBOA:PRELOAD=TRUE
ANNUBOA:RELEASE=TRUE
ANNUBOA:MONITORCOLLISION=FALSE
ANNUBOA:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNBUTTONMASK
ANNBUTTONMASK:TYPE=ANIMO
ANNBUTTONMASK:VISIBLE=FALSE
ANNBUTTONMASK:FILENAME=DOM\BUTTON_MASK.ANN
ANNBUTTONMASK:TOCANVAS=TRUE
ANNBUTTONMASK:PRIORITY=399
ANNBUTTONMASK:FPS=16
ANNBUTTONMASK:PRELOAD=TRUE
ANNBUTTONMASK:RELEASE=TRUE
ANNBUTTONMASK:MONITORCOLLISION=FALSE
ANNBUTTONMASK:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNDOORMASK
ANNDOORMASK:TYPE=ANIMO
ANNDOORMASK:VISIBLE=FALSE
ANNDOORMASK:FILENAME=DOM\DOOR_MASK.ANN
ANNDOORMASK:TOCANVAS=TRUE
ANNDOORMASK:PRIORITY=399
ANNDOORMASK:FPS=16
ANNDOORMASK:PRELOAD=TRUE
ANNDOORMASK:RELEASE=TRUE
ANNDOORMASK:MONITORCOLLISION=FALSE
ANNDOORMASK:MONITORCOLLISIONALPHA=FALSE

OBJECT=CNVINIT
CNVINIT:TYPE=BEHAVIOUR
CNVINIT:CODE={LOG^PUT("Dzialam!");BEHMUSICSET^RUN("DOM");CLSWALKEROBJ^NEW("KRET");KRET^LOADANIM("KRET16");KRET^SETSPEED(3.0);DBDIALOGI^REMOVEALL();DBDIALOGI^LOAD("DOM\DIALOGI.DTA");BEHDIALOGSTOP^RUN(FALSE);CANVASOBSERVER^SETBACKGROUND("DOM\BKG1.IMG");BEHINITPLAN^RUN(TRUE);KRET^LOADPATH("DOM\PATHS","IDLE",800,600);KRET^SETPOS(GSAVE^GET("ARCADE_LEADER_POS_X"),GSAVE^GET("ARCADE_LEADER_POS_Y"),FALSE);KRET^SETPATH(1,TRUE);@IF(GSAVE^GET("DOM_STATUS"),"_",""NIEODWIEDZONY"","BFIRST","");}

OBJECT=BFIRST
BFIRST:TYPE=BEHAVIOUR
BFIRST:CODE={}

OBJECT=BEHINITPLAN
BEHINITPLAN:TYPE=BEHAVIOUR
BEHINITPLAN:CODE={}
