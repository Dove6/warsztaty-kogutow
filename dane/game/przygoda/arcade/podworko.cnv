OBJECT=IPLANSZALAST
IPLANSZALAST:TYPE=INTEGER
IPLANSZALAST:VALUE=0

OBJECT=SWALKERSIGNAL
SWALKERSIGNAL:TYPE=STRING
SWALKERSIGNAL:ONBRUTALCHANGED^KRET_TARGET_REACHED={SKRETTARGETACTIONSEL^SET([""+SCLICKSEL]);}
#SWALKERSIGNAL:ONBRUTALCHANGED^KRET_GO_ON={SKRETGOONACTIONSEL^SET([""+KRET^GETNEXTSTEPX()+"_"+KRET^GETNEXTSTEPY()]);}

#OBJECT=SKRETGOONACTIONSEL
#SKRETGOONACTIONSEL:TYPE=STRING
#SKRETGOONACTIONSEL:ONBRUTALCHANGED^27_21={}

# Action after player gets to destination.

OBJECT=SKRETTARGETACTIONSEL
SKRETTARGETACTIONSEL:TYPE=STRING
SKRETTARGETACTIONSEL:ONBRUTALCHANGED={GSAVE^SET("ARCADE_LEADER_POS_X",KRET^GETPOSX());GSAVE^SET("ARCADE_LEADER_POS_Y",KRET^GETPOSY());}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^WECHIKUL={GSAVE^SET("ARCADE_SCENE_NAME","LAST_ROOM");BEHGOTOSCENE^RUN();}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^ANNKOGUT={ /
    I1^SET(GSAVE^GET("KOGUT_STAGE")); /
    @IF("SITEMUSED","_",""WAZNY_PRZEDMIOT"","{ /
        INV^REMOVE("WAZNY_PRZEDMIOT"); /
        GSAVE^SET("KOGUT_STAGE",2); /
        BEHDIALOGPLAY^RUN("KOGUT3",FALSE); /
        I1^SET(-1); /
    }",""); /
/
    @IF("SITEMUSED","_",""WAZNIEJSZY_PRZEDMIOT"","{ /
        INV^REMOVE("WAZNIEJSZY_PRZEDMIOT"); /
        GSAVE^SET("KOGUT_STAGE",3); /
        BEHDIALOGPLAY^RUN("KOGUT4",FALSE); /
        BEHSHOWSOFA^RUN(); /
        I1^SET(-1); /
    }",""); /
/
    @IF("SITEMUSED","_",""NAJWAZNIEJSZY_PRZEDMIOT"","{ /
        INV^REMOVE("NAJWAZNIEJSZY_PRZEDMIOT"); /
        GSAVE^SET("KOGUT_STAGE",3); /
    }",""); /
/
    @IF("I1","_","0","{ /
        BEHDIALOGPLAY^RUN("KOGUT0",FALSE); /
        GSAVE^SET("KOGUT_STAGE",1); /
    }","{}"); /
/
    @IF("I1","_","1","{ /
        BEHDIALOGPLAY^RUN("KOGUT1",FALSE); /
    }","{}"); /
/
    @IF("I1","_","2","{ /
        BEHDIALOGPLAY^RUN("kogut3b",FALSE); /
    }","{}"); /
/
    @IF("I1","_","3","{ /
        BEHDIALOGPLAY^RUN("kogut5",FALSE); /
    }","{}");}

SKRETTARGETACTIONSEL:ONBRUTALCHANGED^ANNKURNIKIMASK={ /
    @IF("GSAVE^GET("KOGUT_STAGE")",">","1","{ /
        GSAVE^SET("ARCADE_SCENE_NAME","KURNIKI"); /
        GSAVE^SET("ARCADE_LEADER_POS_X",4); /
        GSAVE^SET("ARCADE_LEADER_POS_Y",15); /
        BEHGOTOSCENE^RUN(); /
    }","{ /
        BEHDIALOGPLAY^RUN("KURNIKI_NIE",FALSE); /
    }"); /
}
SKRETTARGETACTIONSEL:ONBRUTALCHANGED^WAZNY_PRZEDMIOT={}

# After clicking an object, sets the position player character should go to.
OBJECT=SCLICKSEL
SCLICKSEL:TYPE=STRING
SCLICKSEL:ONBRUTALCHANGED={@IF(MOUSE^GETPOSY(),">","0","{KRET^GOTOMOUSE(IMOUSEX,IMOUSEY);}","");}
SCLICKSEL:ONBRUTALCHANGED^KRET={INV^ROZWIN(KRET^GETCENTERX(),KRET^GETCENTERY());}
SCLICKSEL:ONBRUTALCHANGED^ANNKOGUT={KRET^GOTO(14,13);}
SCLICKSEL:ONBRUTALCHANGED^ANNKURNIKIMASK={KRET^GOTO(6,6);}
SCLICKSEL:ONBRUTALCHANGED^WAZNY_PRZEDMIOT={KRET^GOTO(5,13);}
SCLICKSEL:ONBRUTALCHANGED^WECHIKUL={KRET^GOTO(11,13);}

OBJECT=POSTESTER
POSTESTER:TYPE=BEHAVIOUR
POSTESTER:CODE={KRET^SHOWINFO(MOUSE^GETPOSX(),MOUSE^GETPOSY());}

# Action after hovering over object.
OBJECT=SFOCUSSEL
SFOCUSSEL:TYPE=STRING
SFOCUSSEL:ONCHANGED={CURSOR^SET("STD");}
SFOCUSSEL:ONCHANGED^ANNKOGUT={CURSOR^SET("ACTIVE");}
SFOCUSSEL:ONCHANGED^ANNKURNIKIMASK={CURSOR^SET("EXIT");}
SFOCUSSEL:ONCHANGED^WAZNY_PRZEDMIOT={CURSOR^SET("ACTIVE");}
SFOCUSSEL:ONCHANGED^WECHIKUL={CURSOR^SET("ACTIVE");}

# Action that happens after specified dialogue is finished.
OBJECT=SDIALOGSIGNAL
SDIALOGSIGNAL:TYPE=STRING
SDIALOGSIGNAL:ONBRUTALCHANGED^KOGUT0={}

OBJECT=BJPKZAGADANE
BJPKZAGADANE:TYPE=BOOL
BJPKZAGADANE:VALUE=FALSE


OBJECT=BEHSHOWSOFA
BEHSHOWSOFA:TYPE=BEHAVIOUR
BEHSHOWSOFA:CODE={ /
    WECHIKUL^SETPOSITION(0,0); /
    P1^SETFRAME("WAZNY_PRZEDMIOT",0); /
    P1^SETPOSITION(405,290); /
}



OBJECT=ANNKOGUT
ANNKOGUT:TYPE=ANIMO
ANNKOGUT:VISIBLE=TRUE
ANNKOGUT:FILENAME=PODWORKO\KOGUT.ANN
ANNKOGUT:TOCANVAS=TRUE
ANNKOGUT:PRIORITY=400

OBJECT=WECHIKUL
WECHIKUL:TYPE=ANIMO
WECHIKUL:VISIBLE=TRUE
WECHIKUL:FILENAME=PODWORKO\WECHIKUL.ANN
WECHIKUL:TOCANVAS=TRUE
WECHIKUL:PRIORITY=400

OBJECT=P1
P1:TYPE=ANIMO
P1:VISIBLE=TRUE
P1:FILENAME=INV_ITEMS.ANN
P1:TOCANVAS=TRUE
P1:PRIORITY=400

OBJECT=ANNKURNIKIMASK
ANNKURNIKIMASK:TYPE=ANIMO
ANNKURNIKIMASK:VISIBLE=FALSE
ANNKURNIKIMASK:FILENAME=PODWORKO\KURNIKI_MASK.ANN
ANNKURNIKIMASK:TOCANVAS=TRUE
ANNKURNIKIMASK:PRIORITY=399
ANNKURNIKIMASK:FPS=16
ANNKURNIKIMASK:PRELOAD=TRUE
ANNKURNIKIMASK:RELEASE=TRUE
ANNKURNIKIMASK:MONITORCOLLISION=FALSE
ANNKURNIKIMASK:MONITORCOLLISIONALPHA=FALSE

OBJECT=CNVINIT
CNVINIT:TYPE=BEHAVIOUR
CNVINIT:CODE={BEHMUSICSET^RUN("PODWORKO");CLSWALKEROBJ^NEW("KRET");KRET^LOADANIM("KRET22");KRET^SETSPEED(3.0);DBDIALOGI^REMOVEALL();DBDIALOGI^LOAD("PODWORKO\DIALOGI.DTA");BEHDIALOGSTOP^RUN(FALSE);CANVASOBSERVER^SETBACKGROUND("PODWORKO\BKG.IMG");BEHINITPLAN^RUN(TRUE);KRET^LOADPATH("PODWORKO\PATHS","IDLE",800,600);KRET^SETPOS(GSAVE^GET("ARCADE_LEADER_POS_X"),GSAVE^GET("ARCADE_LEADER_POS_Y"),FALSE);KRET^SETPATH(1,TRUE);@IF(GSAVE^GET("PODWORKO_STATUS"),"_",""NIEODWIEDZONY"","BFIRST","");}

OBJECT=BFIRST
BFIRST:TYPE=BEHAVIOUR
BFIRST:CODE={GSAVE^GSET(["SLOT"+IGSLOTNO+"_STATUS"],"FULL");GSAVE^SET("PODWORKO_STATUS","ODWIEDZONY");}

OBJECT=BEHINITPLAN
BEHINITPLAN:TYPE=BEHAVIOUR
BEHINITPLAN:CODE={ /
    @IF(GSAVE^GET("WAZNY_PRZEDMIOT"),"_","1","{WAZNY_PRZEDMIOT^SETPOSITION(1000,1000);}",""); /
    WECHIKUL^SETPOSITION(1000,1000); /
    P1^SETPOSITION(1000,1000); /
    @IF(GSAVE^GET("KOGUT_STAGE"),">","2","BEHSHOWSOFA",""); /
}
